暂无，修改并重新投稿

现有的蛋白质配体亲和度预测方法可以基于使用的数据划分为两类：第一种使用了基于结构的原子级特征，但由于蛋白质包含的原子过多，很多方法使用cutoff剔除了离配体较远的蛋白质原子，而这个操作造成了蛋白质链的断裂。但根据现实中的直觉，虽然一条绳子远端的作用力可能无法直接影响近端，但可能存在作用力的传导。第二种使用了非结构的序列信息，该数据没有结构数据精确，蛋白质的描述更是基于比原子更高的氨基酸维度，仅仅使用序列信息进行预测可能没有真正学习到蛋白质和配体间的作用力。
根据上述问题，我们需要提出一种新的方法，既要使用更加准确的基于结构的原子级特征，又要通过氨基酸序列描述完整的蛋白质信息，并使融合模型提取互补特征，关注到上述两种主流方法缺失的潜在作用力，进一步提高方法精度。

我们关注了两个维度的蛋白质和配体的相互作用，包括口袋内原子间相互作用模块和氨基酸序列相互作用模块。其中口袋模块提取了每个原子的间的作用，序列模块关注整体氨基酸序列对配体的整体影响。为了更好地让两个模块融合，我们加入了前期坐标融合，中期虚拟节点融合和后期NTN模块融合。

我们使用pyptorch，两个模块均通过pyg实现了图神经网络。在口袋模块中，我们提取了口袋蛋白质原子、配体原子的基本特征和坐标、邻接距离等信息。该模块在PDBbind2016精化集上训练，并在核心集上测试，其RMSE为1.30。在序列模块中，我们使用了tape方法生成的1900维的embedding作为氨基酸特征，每个氨基酸根据原子结构信息中对应的阿尔法碳原子进行定位，在核心集上RMSE达到了1.35。最后我们选取两个模块生成的512维隐藏层表示输入NTN进行融合，RMSE进一步下降至1.06，证明了多重融合模块的有效性。

单从模型在核心集上的各项精度上来说，实验验证了前期坐标融合、后期NTN融合的有效性。其中，使用结构信息的口袋模块具有较好的泛化能力，在额外测试集上的RMSE依然能达到1.3，但使用非结构信息的序列模块仅能达到1.5左右的结果，最终该模型在融合后的泛化能力尚不明确，暂时未在额外测试集上取得满意的结果。

在基于第一个研究点的基础上，我们进一步探究了模型充分融合的可能方式。针对配体原子无法获取远程氨基酸环境信息的问题，我们提出了中期虚拟节点融合方法。

我们导入了gtrick包，将虚拟节点加入配体GAT中的后两层，我们分析了实验数据和加入层的位置。总体而言该方法是有效的。

我们将tape方法获得的氨基酸序列embedding压缩为氨基酸整体特征，记作ami，将其作为虚拟节点。在配体GAT层后，使用gtrick中方法更新配体节点信息，新的原子特征为每个原子的特征加上氨基酸embedding，并在该层后更新虚拟节点ami的特征。

在研究点1中，口袋模块能够在核心集上得到1.3左右的精度，添加了中期虚拟节点融合后，配体对整体蛋白质序列环境有了基本的认识，而不是局限于口袋环境，RMSE进一步下降至1.27左右。

在预测蛋白质配体亲和度问题上，两两原子的间距直接决定了它们之间是否存在直接的相互作用，在模块中加入距离特征是很多方法提高精度的一个方向，有直接加入坐标信息，也有的采用了空间桶原理，但尚未进一步研究不同距离的原子对某个原子的作用权重。
我们需要提出新的距离划分方式，对不同的原子给与不同的权重，并研究多少埃范围内，对原子产生了最大的作用。

我们根据多头attention机制的思想，提出了基于距离的多头注意力方法，在多个数据集上完成了测试，与自身变体模型和现有模型进行了对比，验证了方法的有效性。

提出方法的基本思想是：
首先获得配体原子和5埃内口袋原子的距离矩阵，其中数据分布在0埃到12埃左右，我们根据距离将距离矩阵划分为8个子距离矩阵，例如第一个子距离矩阵代表了距离为0埃到2埃的所有交互关系，如果存在则为1，不存在则为0……第8个子距离矩阵代表了距离大于8埃的所有交互关系，如果存在则为1，不存在则为0。在其他方法中，往往将距离的划分间距固定为1，这可能是不合理的，因为两两原子的直接非共价键作用力距离为小于5埃，而1埃、2埃内的间距又极为稀少，所以强调3埃、4埃、5埃范围的原子间距是必要的，在这里我们将划分距离设为0.5，并于全局设为1的方法进行对比。
接着，把通过图神经网络得到的配体原子和口袋原子相乘，可以将其视为attention机制中的q和k，并生成8个头，头的数量与子距离矩阵一一对应，将其对位相乘，得到了多头attention权重矩阵。
最后再分别与原始配体特征、口袋特征相乘，即attention机制中权重矩阵乘以v。在其中添加残差链接，得到含有完整距离交互信息的配体特征和口袋特征。

经过消融实验，基于距离的多头attention机制能够关注到不同距离的原子对该原子的相互作用。其中3埃到4埃的权重矩阵置零会导致模型性能的大幅下降，证明了该部分非共价键作用力的重要性。其次，8埃以外的距离信息也对模型整体的产生了精度的提升，我们猜测这是因为该区间原子数目较多，并且对内层的口袋原子有一定的间接相互作用。在核心集上，添加该模块能将RMSE从1.45下降至1.33左右，在额外测试集上也有相似的效果，实验证明该方法能够大幅提高模型的精度和泛化能力。